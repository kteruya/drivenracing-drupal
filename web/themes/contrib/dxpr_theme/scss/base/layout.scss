@import "../includes/variables";

// Horizontal scroll prevention

html {
  // Ensure box-sizing is border-box for all elements
  box-sizing: border-box;

  // Prevent horizontal scrolling on small devices
  overflow-x: hidden !important;
}

*, *::before, *::after {
  box-sizing: inherit;
}

body {
  background: dxpr-color('body');
  background-attachment: fixed;
  background-position: center center;
  background-size: cover;
  font-size:  var(--dxt-setting-body-font-size);
  overflow-x: hidden !important;
}

.main-container {
  position: relative; // Centering mini tabs while using side toolbar
}

// responsive image. This sometimes sucks because images cannot over overscan their base size to save bytes.
img {
  height: auto;
  max-width: 100%; // can't remove this because then image will overflow parent elements.
}

// Specific elements that commonly cause horizontal scroll issues
pre, code, table {
  max-width: 100%;
  overflow-x: auto;
}

// Mobile-specific overflow prevention
@media screen and (width <= 768px) {
  html, body {
    max-width: 100vw !important;
    overflow-x: hidden !important;
    position: relative;
    width: 100% !important;
  }
}

// Correction for vertical admin toolbar.
@media screen and (width >= 610px) and (width <= 768px) {
  body.toolbar-tray-open {
    max-width: calc(100vw - var(--drupal-displace-offset-left, 0)) !important;
  }
}

/* Applies to non-gin admin. */
body.user-logged-in:not([data-gin-accent]) {
  &.toolbar-horizontal,
  &.toolbar-vertical,
  &.toolbar-fixed {
    padding-top: var(--drupal-displace-offset-top, 0) !important;
  }
}

.dxpr-theme-boxed-container {
  background: white;
  margin: 0 auto;
  max-width: var(--dxt-setting-box-max-width);
}

.row {
  margin-left: calc(-1 * var(--dxt-setting-gutter-horizontal) / 2);
  margin-right: calc(-1 * var(--dxt-setting-gutter-horizontal) / 2);
}

.row > * {
  margin-bottom: var(--dxt-setting-gutter-vertical);
  padding-left: calc(var(--dxt-setting-gutter-horizontal) / 2);
  padding-right: calc(var(--dxt-setting-gutter-horizontal) / 2);
}

.container {
  max-width: var(--dxt-setting-layout-max-width);
  padding-left: var(--dxt-setting-gutter-container);
  padding-right: var(--dxt-setting-gutter-container);
}

// navbar and page-title padding is not user-controlled and should be kept
// away from viewport edge
.navbar-container.dxpr-theme-fluid,
.page-title-container.dxpr-theme-fluid,
.container-fluid {
  padding-left: calc(var(--dxt-setting-gutter-horizontal) / 2);
  padding-right: calc(var(--dxt-setting-gutter-horizontal) / 2);
}


.body--dxpr-theme-nav-mobile {
  .container {
    padding-left: calc(var(--dxt-setting-gutter-container-mobile) / 2);
    padding-right: calc(var(--dxt-setting-gutter-container-mobile) / 2);
  }

  .navbar-container.dxpr-theme-fluid,
  .page-title-container.dxpr-theme-fluid,
  .container-fluid {
    padding-left: calc(var(--dxt-setting-gutter-horizontal-mobile) / 2);
    padding-right: calc(var(--dxt-setting-gutter-horizontal-mobile) / 2);
  }

  .row {
    margin-left: calc(-1 * var(--dxt-setting-gutter-horizontal-mobile) / 2);
    margin-right: calc(-1 * var(--dxt-setting-gutter-horizontal-mobile) / 2);
  }

  .row > * {
    margin-bottom: var(--dxt-setting-gutter-vertical-mobile);
    padding-left: calc(var(--dxt-setting-gutter-horizontal-mobile) / 2);
    padding-right: calc(var(--dxt-setting-gutter-horizontal-mobile) / 2);
  }
}

body.full-width-content {
  .main-container > .row,
  .main-container > .row > section,
  .main-container {
    margin: 0;
    padding: 0;
    width: 100%;
  }

  .main-container > .row > aside {
    display: none;
  }
}

.container-row .container-col {
  margin-bottom: 0; // Don't add defaulting margin to these structural columns
}

// BLOCKS
.block-hr {
  display: none;
}

.region-sidebar-first .block,
.region-sidebar-second .block {
  margin-bottom: var(--dxt-setting-gutter-vertical);
}

// Apply background only to blocks without preset background classes
.region-block-design .block:not(.card, [class*="bg-"], [class*="dxpr-theme-util-background"]) {
  background-color: var(--dxt-setting-block-background);
}

// Apply other block styles only to non-card blocks
.region-block-design .block:not(.card) {
  border-color: var(--dxt-setting-block-border-color);
  border-radius: var(--dxt-setting-block-border-radius);
  border-style: solid;
  border-width: var(--dxt-setting-block-border);
  padding: var(--dxt-setting-block-padding);
}

// Apply title background only when block and title don't have preset classes
.region-block-design .block:not(.card, [class*="bg-"], [class*="dxpr-theme-util-background"]) .block-title:not(.card, [class*="bg-"], [class*="dxpr-theme-util-background"]) {
  background-color: var(--dxt-setting-title-background);
}

// Apply other title styles only when parent block is not using card classes
.region-block-design .block:not(.card) .block-title:not(.card) {
  border-color: var(--dxt-setting-title-border-color);
  border-radius: var(--dxt-setting-title-border-radius);
  border-style: solid;
  border-width: var(--dxt-setting-title-border);
  font-size: var(--dxt-setting-title-font-size);
  padding: var(--dxt-setting-title-padding);
  text-align: var(--dxt-setting-title-align);
}

.region-block-design .block-hr {
  border-top-color: var(--dxt-setting-block-divider-color);
  border-top-width: var(--dxt-setting-block-divider-thickness);
  display: block;
  margin:
    var(--dxt-setting-block-divider-spacing)
    auto
    var(--dxt-setting-block-divider-spacing)
    var(--dxt-setting-divider-position-block);
  width: var(--dxt-setting-block-divider-length);
}

@media screen and (width <= 768px) {
  .region-block-design .block-title {
    font-size: var(--dxt-setting-title-font-size-mobile);
  }
}

#block-system-help {
  margin-bottom: 0;
}

.navbar {
  margin-bottom: 0;
}

// NODES

.node {
  // margin-bottom: 30px;
  .submitted {
    display: block;
    margin-bottom: 30px;
    padding: 15px 0;
  }

  &.node-blog-node-teaser {
    .links {
      margin-top: -15px;
    }
  }
}

// Card view mode - ensure images have no border radius
body .card.node--view-mode-card img {
  border-radius: 0 !important;
}

.teaser {
  margin-bottom: 30px;
}

// SLIDER REGION
.region-slider {
  .block {
    margin-bottom: 0;
  }
}

// FOOTER
.dxpr-theme-footer {
  background-color: dxpr-color('footer');
  border-color: dxpr-color('footertext');
  color: dxpr-color('footertext');
  padding: 0;

  .footer-container {
    padding-bottom: 0;
    padding-top: 15px;
  }

  h1, h2, h3, h4, h5, h6 {
    color: dxpr-color('footertext');
  }

  a {
    color: dxpr-color('footertext');

    &:hover,
    &:focus {
      color: dxpr-color('footertext');
    }
  }

  ul.contact-info {
    padding: 1em 0;

    li {
      background: none;
      font-size: 1.6em;
      line-height: 1.7em;
      padding: 0;
    }
  }

  .block {
    margin-bottom: 0;
    padding-bottom: 0;
  }

  .badge {
    font-size: 11px;
    font-weight: normal;
    opacity: 0.9;
  }
}

// STICKY FOOTER Flexbox method
// https://css-tricks.com/couple-takes-sticky-footer/
.html--dxpr-theme-sticky-footer {
  height: 100%;

  body,
  .dialog-off-canvas-main-canvas {
    display: flex;
    flex-direction: column;
    height: 100%;
  }

  .wrap-containers {
    flex: 1 0 auto;
  }

  .body--dxpr-theme-nav-desktop .dxpr-theme-header--top.affix {
    min-height: 60px;
  }

  footer {
    flex-shrink: 0;
  }
}

// Region content style
.region-content {
  padding: 0;
}

body #edit-block-advanced #edit-block-divider-thickness-wrapper,
body #edit-block-advanced #edit-block-divider-length-wrapper,
body #edit-block-advanced #edit-block-divider-spacing-wrapper,
body #edit-layout #edit-box-max-width-wrapper {
  border: none;
}

//
// Skip to content link
//
.skip-link {
  background: #ff0;
  border: 1px solid #333;
  border-radius: 0 0 8px 8px;
  box-shadow: 0 0 10px rgba(0 0 0 / 25%);
  color: #333 !important;
  display: inline-block;
  font-size: 16px;
  font-weight: bold;
  left: 16px;
  opacity: 0;
  padding: 12px 15px;
  position: absolute;
  text-decoration: none !important;
  top: 0;
  transform: translateY(-110%);
  transition: all 0.3s;
  z-index: 10000;

  &:focus {
    opacity: 1;
    transform: translateY(0%);
  }
}
